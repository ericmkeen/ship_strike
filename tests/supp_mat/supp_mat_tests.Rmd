---
title: "Supplemental Materials"
author: "Eric Keen et al."
date: "8/15/2022"
output:
  html_document:
    df_print: paged
header-includes: \usepackage{longtable}
---

```{r setup, include=FALSE}
#knitr::opts_chunk$set(fig.pos = "!H", out.extra = "")

library(dplyr)
library(ggplot2)
library(readr)
library(knitr)
library(kableExtra)
library(bangarang)
library(ggridges)

library(devtools)
document('../../')

month_initials <- c('J','F','M','A','M','J','J','A','S','O','N','D')
```


```{r, echo=FALSE, eval=TRUE, warning = FALSE, message = FALSE, fig.height=5, fig.width = 8}
ais <- readRDS('../ais/AIS_2019_cleaned.RData')

aistab <- ais_table(ais)
aistab <- aistab %>% select(1,2,4,8:ncol(aistab))
names(aistab) <- c('Type','VIDs','Transits',
                   'mean', 'sd', 'max', 
                   'mean', 'sd', 'min', 'max', 
                   'mean', 'sd', 'min', 'max',
                   'mean', 'sd', 'min', 'max')
knitr::kable(aistab,
             booktabs = TRUE, linesep = '',
             caption = 'Summary of 2019 marine traffic within the lower Kitimat Fjord System, as reported by archival AIS data.') %>%
  kable_styling(font=11) %>% 
   add_header_above(header=c(" " = 3, 
                            "Speed (kn)" = 3, 
                            'Length (m)' = 4,
                            'Beam (m)' = 4,
                            'Draft (m)' = 4)) %>% 
  row_spec (0, bold = T)
```


```{r, echo=FALSE, eval=TRUE, warning = FALSE, message = FALSE}
spp <- c('Fin whale', 'Humpback whale')
Formula <- c('(Lat x Lon) + seafloor depth + seafloor range',
             '(Lat x Lon x DOY) + seafloor depth + seafloor range + year')
td <- c('2.0 km', '2.7 km')
fam <- c('Tweedie', 'Tweedie')
linkf <- c('log','log')
deltaic <- c(104, 14)
devexp <- c("54%", "51%")

dsmtab <- tibble(Species = spp,
                 Formula,
                 `Trunc. dist.`=td,
                 Family = fam,
                 `Link function` = linkf,
                 `Delta AIC` = deltaic,
                 `Deviance explained` = devexp)

knitr::kable(dsmtab,
             longtable = T,
             booktabs = TRUE,
             caption = 'Best-fitting density surface models for fin whales and humpback whales for mid-June â€“ early-September.') %>%
  kable_styling(font=11) %>% 
  column_spec(2, width = "10em")

```

```{r, echo=FALSE, eval=TRUE, warning = FALSE, message = FALSE, fig.height=5, fig.width = 8}
# FIN WHALES
d_fw <- readRDS('d_fw.RData')
knitr::kable(d_fw,
             booktabs = TRUE, linesep = '',
             longtable = T,
             caption = 'Fin whale density (95\\% confidence interval) by waterway (whales per square km), , as estimated from the best-fitting density surface model. Confidence intervals are estimated using a bootstrap procedure.') %>%
  kable_styling(font_size = 7) %>% row_spec(0, bold=T)
```


**Table S1.x.**  Dimensions of the LNG Canada fleet, adapted from TERMPOL (2015). Note that in our analyses, we reduced the max Shell length to 298m, and the beam was adjusted according to the original length:beam ratio. 
<p align="center">
![](lng_fleet.png){width=85%}
</p>
